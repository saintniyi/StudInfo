@model StudInfoModel.ViewModels.StudentVM

@{
    ViewData["Title"] = "Delete Student";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<form method="post" enctype="multipart/form-data">

    <input id="studId" asp-for="Student.Id" hidden />

    <div class="border p-3 mt-3">

        <div class="row mb-3">
            <h2 class="ms-4">Delete Student</h2>
        </div>

        <div class="row">
            <div class="col-8 ms-4">

                <div class="border ms-2 my-2">
                    <div class="row">

                        <div class="mb-2">
                            <label asp-for="Student.StudNos"></label>
                            <input asp-for="Student.StudNos" readonly class="form-control" />
                            <span asp-validation-for="Student.StudNos" class="text-danger"></span>
                        </div>
                        <div class="mb-3 col-6">
                            <label asp-for="Student.FirstName"></label>
                            <input asp-for="Student.FirstName" readonly class="form-control" />
                            <span asp-validation-for="Student.FirstName" class="text-danger"></span>
                        </div>
                        <div class="mb-3 col-6">
                            <label asp-for="Student.LastName"></label>
                            <input asp-for="Student.LastName" readonly class="form-control" />
                            <span asp-validation-for="Student.LastName" class="text-danger"></span>
                        </div>
                        <div class="mb-3 col-6">
                            <label asp-for="Student.Email"></label>
                            <input asp-for="Student.Email" readonly class="form-control" />
                            <span asp-validation-for="Student.Email" class="text-danger"></span>
                        </div>
                        <div class="mb-3 col-6">
                            <label asp-for="Student.PhoneNos"></label>
                            <input asp-for="Student.PhoneNos" readonly class="form-control" />
                            <span asp-validation-for="Student.PhoneNos" class="text-danger"></span>
                        </div>
                        <div class="mb-3 col-4">
                            <label asp-for="Student.Sex"></label>
                            <select asp-for="Student.Sex" disabled asp-items="Html.GetEnumSelectList<@StudInfoModel.Gender>()" class="form-select">
                                <option disabled selected>--Select Sex--</option>
                            </select>
                            <span asp-validation-for="Student.Sex" class="text-danger"></span>
                        </div>
                        <div class="mb-3 col-4">
                            <label asp-for="Student.DOB"></label>
                            <input asp-for="Student.DOB" readonly class="form-control" />
                            <span asp-validation-for="Student.DOB" class="text-danger"></span>
                        </div>
                        <div class="mb-3 col-4">
                            <label asp-for="Student.AdmissionDate"></label>
                            <input asp-for="Student.AdmissionDate" readonly class="form-control" />
                            <span asp-validation-for="Student.AdmissionDate" class="text-danger"></span>
                        </div>
                        <div class="mb-3 col-6">
                            <label asp-for="Student.Pix" class="form-label">Upload pix here</label>
                            <input asp-for="Student.Pix" disabled class="form-control" type="file" id="formFile">
                        </div>
                        <div class="mb-3 col-6">
                            <label asp-for="Student.DeptCode"></label>
                            <select asp-for="Student.DeptCode" disabled asp-items="Model.DeptList" class="form-select">
                                <option selected>--Select Dept--</option>
                            </select>
                            <span asp-validation-for="Student.DeptCode" class="text-danger"></span>
                        </div>
                        <div class="mb-3 col-6">
                            <label asp-for="Student.DegreeProgramName"></label>
                            <select asp-for="Student.DegreeProgramName" disabled asp-items="Html.GetEnumSelectList<StudInfoModel.ProgramName>()" class="form-select">
                                <option selected>--Degree Program Name--</option>
                            </select>
                            <span asp-validation-for="Student.DegreeProgramName" class="text-danger"></span>
                        </div>
                        <div class="mb-3 col-6">
                            <label asp-for="Student.DegreeTitleToBeAwarded"></label>
                            <select asp-for="Student.DegreeTitleToBeAwarded" disabled asp-items="Html.GetEnumSelectList<StudInfoModel.DegreeTitle>()" class="form-select">
                                <option selected>--Degree Title--</option>
                            </select>
                            <span asp-validation-for="Student.DegreeTitleToBeAwarded" class="text-danger"></span>
                        </div>
                        <div class="mb-3 col">
                            <label asp-for="Student.Remarks"></label>
                            <input asp-for="Student.Remarks" readonly class="form-control" />
                            <span asp-validation-for="Student.Remarks" class="text-danger"></span>
                        </div>


                        @*<div class="mb-3 col-6">
                            <label asp-for="Student.Level"></label>
                            <input asp-for="Student.Level" readonly class="form-control" />
                            <span asp-validation-for="Student.Level" class="text-danger"></span>
                        </div>
                        <div class="mb-3 col-6">
                            <label asp-for="Student.Semester"></label>
                            <input asp-for="Student.Semester" readonly class="form-control" />
                            <span asp-validation-for="Student.Semester" class="text-danger"></span>
                        </div>
                        <div class="mb-3 col-4">
                            <label asp-for="Student.LatestEnrollGrpCode"></label>
                            <input asp-for="Student.LatestEnrollGrpCode" readonly class="form-control" />
                            <span asp-validation-for="Student.LatestEnrollGrpCode" class="text-danger"></span>
                        </div>
                        <div class="mb-3 col-4">
                            <label asp-for="Student.GPA"></label>
                            <input asp-for="Student.GPA" readonly class="form-control" />
                            <span asp-validation-for="Student.GPA" class="text-danger"></span>
                        </div>
                        <div class="mb-3 col-4">
                            <label asp-for="Student.CGPA"></label>
                            <input asp-for="Student.CGPA" readonly class="form-control" />
                            <span asp-validation-for="Student.CGPA" class="text-danger"></span>
                        </div>*@

                        
                        <div class="mb-3 mt-3 text-end">

                            <button id="btnRemove" class="btn btn-primary"><i class="bi bi-trash-fill"></i>&nbsp;Remove</button>

                            <a class="btn btn-info" asp-controller="Student" asp-action="Index" style="width:150px;">Back to List</a>

                        </div>

                    </div>
                </div>

            </div>

            <div class="col-2 ms-4">
                @*Display existing photo here*@
                <img class="imageThumbnail" src="@ViewBag.ImageDataUrl" asp-append-version="true" />
            </div>

        </div>

    </div>

</form>




@section Scripts {
    @{
        await Html.RenderPartialAsync("_ValidationScriptsPartial");
    }

    }




    <script src="~/lib/jquery/dist/jquery.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js"></script>

    <script>


        $(document).ready(function() {
            $("#btnRemove").click(function(e) {
                e.preventDefault();
                showAlert();
            })
        })


        function showAlert() {
            Swal.fire({
                title: 'Are you sure?',
                text: "You won't be able to revert this!",
                icon: 'warning',
                showCancelButton: true,
                confirmButtonColor: '#3085d6',
                cancelButtonColor: '#d33',
                confirmButtonText: 'Yes, delete it!'
            }).then((result) => {
                if (result.isConfirmed) {
                    id = $("#studId").val()
                    Remove(id)
                }
            })
        }


        function Remove(id) {
            $.ajax({
                url: "@Url.Action("RemoveStudent")",
                type: 'DELETE',
                data: { ID: id },
                success: function(result) {
                    if (result.success == true) {
                        toastr.success(result.message)
                        indexUrl = '@Url.Action("Index", "Student")'
                        window.setTimeout(function() { location.href = indexUrl }, 2000) //window.location.href=indexUrl
                    }
                    else {
                        toastr.error('Error occurred. Contact the application administrator.')
                    }
                },
                error: function(req, status, error) {
                    console.log(status)
                }
            })
        }


    </script>